"use strict";(self.webpackChunkcinema_quiz=self.webpackChunkcinema_quiz||[]).push([[301],{7555:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"AqOb_Kbe"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3896:(e,t,n)=>{n.d(t,{Z:()=>s});const s={btn:"qfNxdn_0",primary:"D93lf_uC",secondary:"MjvObtZH",full:"sa2cfRF0",minContent:"ac0L1gon"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3698:(e,t,n)=>{n.d(t,{Z:()=>s});const s={input:"Q_Pov6im"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},8257:(e,t,n)=>{n.d(t,{Z:()=>s});const s={container:"UcmHv9_m",form:"J_WaL6wm",title:"vHm30li_",left:"YjOrunbt",center:"z9Et_3Da",right:"Y8f9sfS_"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3706:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"kmoMZMB_",header:"zB0MpvEd"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},1357:(e,t,n)=>{n.d(t,{Z:()=>s});const s={logo:"sL22ySrC",text:"kqxmnxGG"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3147:(e,t,n)=>{n.d(t,{Z:()=>s});const s={modal:"D5MP1HXo",modal_active:"q4xPvY1V",modal__content:"T8Tn8w78",modal__content_active:"PymjAh24"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},5158:(e,t,n)=>{n.d(t,{Z:()=>s});const s={notfound:"JhhcHpca",title:"NBNE9yms",image:"xy0FiEGI"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},1822:(e,t,n)=>{n.d(t,{Z:()=>s});const s={userBlock:"iI_qxwbv",userIcon:"BXzJKcvj"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},9885:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"yXmhqWQI"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},301:(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var s=n(5893),a=n(7294),r=n(7421),o=n(9175),i=n(9250),l=n(9655),c=n(1357),d=n(9234),u=n(3553);const{Title:h}=d.default,m=a.memo((()=>{const e=(0,i.TH)();return(0,s.jsx)(l.rU,{to:u.$x,className:c.Z.logo,onClick:t=>{e.pathname===u.$x&&t.preventDefault()},children:(0,s.jsx)(h,{level:2,className:c.Z.text,children:"QUIZ LOGO"})})}));var p=n(3706),x=n(1577),j=n(1822),v=n(9366),y=n(4927),g=n(8268);function b(e){return{type:g.zA,payload:e}}function f(e){return{type:g.YG,payload:e}}const Z=(0,n(9465).eI)("https://bomuwhgrujvwagkdtdrd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJvbXV3aGdydWp2d2Fna2R0ZHJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODk2MTYyODYsImV4cCI6MjAwNTE5MjI4Nn0.2LO4Ex7y-KG9iInHcoK3JPIYZMFR0ZiEW6iWQV9YQt0"),w=new class{constructor({baseUrl:e,headers:t}){this.userRegister=async e=>{const{data:t,error:n}=await Z.auth.signUp(e);if(n)throw new Error(n.message.toString());return t},this.userLogin=async e=>{const{data:t,error:n}=await Z.auth.signInWithPassword(e);if(n)throw new Error(n.message.toString());return t},this.userLogout=async()=>{await Z.auth.signOut()},this.fetchQuestions=async()=>{const{data:e,error:t}=await Z.from("questions").select();if(t||0===e.length){const e=t.message||"Нет данных";throw new Error(e.toString())}return e},this.baseUrl=e,this.headers=t}onResponce(e){if(e.ok)return e.json();throw new Error(`${e.status} - ${e.statusText}`)}refreshToken(e){return fetch(`${this.baseUrl}/auth/v1/token?grant_type=refresh_token`,{method:"POST",headers:Object.assign({},this.headers),body:JSON.stringify({refresh_token:e})}).then(this.onResponce).catch((e=>alert(e)))}}({baseUrl:"https://bomuwhgrujvwagkdtdrd.supabase.co",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJvbXV3aGdydWp2d2Fna2R0ZHJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODk2MTYyODYsImV4cCI6MjAwNTE5MjI4Nn0.2LO4Ex7y-KG9iInHcoK3JPIYZMFR0ZiEW6iWQV9YQt0"}});function O(e){const t=(0,a.useMemo)((()=>window.matchMedia(e)),[e]),[n,s]=(0,a.useState)(t.matches);return(0,a.useEffect)((()=>{const e=()=>s(t.matches);return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}),[t]),n}var I=n(3106);const k=a.memo((()=>{const e=(0,r.C)(I.$v),t=(0,r.T)(),n=(0,i.TH)(),{sm:o}={xs:O("(min-width: 480px)"),sm:O("(min-width: 767px)"),md:O("(min-width: 992px)"),lg:O("(min-width: 1200px)")},c=(0,a.useCallback)((()=>{t((e=>{e((0,y.Ub)()),e({type:g.lK}),w.userLogout()}))}),[]);return(0,s.jsxs)("div",{className:j.Z.userBlock,children:[(null==e?void 0:e.email)&&(0,s.jsxs)("span",{children:[(0,s.jsx)(v.Z,{className:j.Z.userIcon}),o&&e.email]}),e?(0,s.jsx)(l.rU,{to:u.$x,children:(0,s.jsx)(x.ZP,{type:"primary",onClick:c,children:"Выйти"})}):(0,s.jsx)(l.rU,{replace:!0,to:u.Qv,state:{backgroundLocation:n,initialPath:n.pathname},children:(0,s.jsx)(x.ZP,{type:"primary",children:"Войти"})})]})}));var N=n(4184),C=n.n(N);const S=()=>(0,s.jsx)("header",{className:p.Z.wrapper,children:(0,s.jsxs)("div",{className:C()("container",p.Z.header),children:[(0,s.jsx)(m,{}),(0,s.jsx)(k,{})]})}),_=e=>JSON.parse(localStorage.getItem(e));function M(e){return{type:g.$E,payload:e}}var E=n(7536),P=n(8257);const J=a.memo((({handleForm:e,children:t,title:n,align:a="center"})=>(0,s.jsx)("div",{className:P.Z.container,children:(0,s.jsxs)("form",{onSubmit:e,className:C()(P.Z.form,{[P.Z[a]]:!!a}),children:[n&&(0,s.jsx)("h3",{className:P.Z.title,children:n}),t]})})));var L=n(3698);const T=(0,a.forwardRef)(((e,t)=>{var n=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n}(e,[]);return(0,s.jsx)("input",Object.assign({ref:t,className:L.Z.input},n))})),F=a.memo(T);var z,A=n(3896);!function(e){e.full="full"}(z||(z={}));const $=a.memo((e=>{var{children:t,color:n,size:a=z.full,extraClass:r}=e,o=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n}(e,["children","color","size","extraClass"]);return(0,s.jsx)("button",Object.assign({},o,{className:C()(A.Z.btn,A.Z[n],{[r]:!!r,[A.Z[a]]:!!a}),children:t}))})),Q={required:{value:!1,message:"Обязательное поле"},pattern:{value:/^[а-яА-ЯёЁa-zA-Z][а-яА-ЯёЁa-zA-Z0-9-_\.]{1,20}$/,message:"Имя должно быть не менее 2 букв и начинаться с буквы"}},q={required:{value:!0,message:"Обязательное поле"},pattern:{value:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Email не соотвествует формату электронной почты"}},U={required:{value:!0,message:"Обязательное поле"},pattern:{value:/^.{8,}$/,message:"Пароль должен содержать минимум восемь символов"}},Y=(e,t)=>{if(t[e])return(0,s.jsx)("p",{className:"error-message",children:t[e].message})};var H=n(7555);const R=a.memo((({title:e,subtitle:t,withButton:n})=>(0,s.jsxs)("div",{className:H.Z.wrapper,children:[e&&(0,s.jsx)("p",{className:"error-message",children:e}),t&&(0,s.jsx)("p",{className:"error-message",children:t}),n&&(0,s.jsx)(l.rU,{to:u.$x,children:(0,s.jsx)(x.ZP,{type:"primary",children:"На главную ошибка"})})]})));var B=n(4324);const G=a.memo((({onSubmit:e,onNavigate:t})=>{const{error:n,loading:o}=(0,r.C)(I.qL),{register:i,handleSubmit:l,formState:{errors:c}}=(0,E.cI)({mode:"onBlur"}),d=i("email",q),h=i("password",U),m=(0,a.useCallback)((()=>{t(u.NM)}),[]);return(0,s.jsxs)(J,{title:"Вход",handleForm:l(e),children:[(0,s.jsx)(F,Object.assign({},d,{id:"email",type:"text",placeholder:"email",autoComplete:"none"})),Y("email",c),(0,s.jsx)(F,Object.assign({},h,{id:"password",type:"password",placeholder:"Пароль"})),Y("password",c),o&&(0,s.jsx)(B.Z,{}),n&&(0,s.jsx)(R,{title:"Ошибка авторизации",subtitle:n}),(0,s.jsx)($,{type:"submit",color:"primary",children:"Войти"}),(0,s.jsx)($,{onClick:m,type:"button",color:"secondary",children:"Зарегистрироваться"})]})})),X=({onlyOnAuth:e,children:t})=>{const n=(0,i.TH)();return(({onlyOnAuth:e,user:t,location:n,children:a})=>{var r,o,l;if(e&&t){const e=(null===(r=null==n?void 0:n.state)||void 0===r?void 0:r.from)||{pathname:u.$x},{backgroundLocation:t}=(null===(l=null===(o=null==n?void 0:n.state)||void 0===o?void 0:o.from)||void 0===l?void 0:l.state)||{backgroundLocation:null};return(0,s.jsx)(i.Fg,{replace:!0,to:e,state:{backgroundLocation:t}})}return e||t?(0,s.jsx)(s.Fragment,{children:a}):(0,s.jsx)(i.Fg,{replace:!0,to:{pathname:u.Qv},state:{from:n}})})({onlyOnAuth:e,user:(0,r.C)(I.$v),location:n,children:t})},{Text:D,Title:W}=d.default,V=a.memo((({onSubmit:e,onNavigate:t})=>{const{error:n,loading:o,authorization:i}=(0,r.C)(I.qL),{register:l,handleSubmit:c,formState:{errors:d}}=(0,E.cI)({mode:"onBlur"}),h=l("name",Q),m=l("email",q),p=l("password",U),x=(0,a.useCallback)((()=>t(u.Qv)),[]);return(0,s.jsxs)(J,{title:"Регистрация",handleForm:c(e),children:[i===u.h$?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{level:3,type:"success",children:"Вы успешно зарегистрированы!"}),(0,s.jsx)(D,{children:"Для входа в систему, необходимо подтвердить свой email"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,Object.assign({},h,{id:"username",type:"text",placeholder:"Имя"})),Y("name",d),(0,s.jsx)(F,Object.assign({},m,{id:"email",type:"email",placeholder:"email"})),Y("email",d),(0,s.jsx)(F,Object.assign({},p,{id:"password",type:"password",placeholder:"Пароль"})),Y("password",d),o&&(0,s.jsx)(B.Z,{}),n&&(0,s.jsx)(R,{title:"Ошибка авторизации",subtitle:n}),(0,s.jsx)("p",{className:"info-text",children:"Для регистрации нужно указать реальный email! Действует ограничение 4 регистрации за 1 час"}),(0,s.jsx)($,{type:"submit",color:"primary",children:"Зарегистрироваться"})]}),(0,s.jsx)($,{onClick:x,type:"button",color:"secondary",children:"Войти"})]})}));var K=n(9885);const ee=function(){const e=(0,r.C)(I.$v),t=(0,i.TH)(),n={hash:"",key:"defailt",pathname:u.e7,state:{}};return(0,s.jsxs)("div",{className:K.Z.wrapper,children:[(0,s.jsx)("h2",{children:"Здесь можно пройти квиз"}),e?(0,s.jsx)(l.rU,{to:u.e7,children:(0,s.jsx)(x.ZP,{type:"primary",children:"Играть"})}):(0,s.jsx)(l.rU,{replace:!0,to:u.Qv,state:{backgroundLocation:t,initialPath:t.pathname,from:n},children:(0,s.jsx)(x.ZP,{type:"primary",children:"Авторизироваться"})})]})};var te,ne=n(5158);function se(){return se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},se.apply(this,arguments)}const ae=function(e){return a.createElement("svg",se({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 80 80"},e),te||(te=a.createElement("path",{d:"M40 6.667C58.41 6.667 73.334 21.59 73.334 40c0 18.41-14.924 33.333-33.334 33.333C21.59 73.333 6.667 58.41 6.667 40 6.667 21.59 21.591 6.667 40 6.667Zm0 5.666C24.72 12.333 12.334 24.72 12.334 40c0 15.28 12.386 27.667 27.666 27.667 15.28 0 27.667-12.387 27.667-27.667 0-15.28-12.387-27.667-27.667-27.667Zm6.787 21c-1.327 0-2.403 1.11-2.403 2.48 0 6.731 5.307 9.92 13.214 9.92 1.326 0 2.402-1.11 2.402-2.48 0-1.37-1.076-2.48-2.402-2.48-5.604 0-8.409-1.686-8.409-4.96 0-1.37-1.075-2.48-2.402-2.48Zm-11.171 2.48c0-1.37-1.076-2.48-2.403-2.48s-2.402 1.11-2.402 2.48l-.018.437c-.243 2.987-3.042 4.523-8.39 4.523-1.327 0-2.403 1.11-2.403 2.48 0 1.37 1.076 2.48 2.402 2.48 7.907 0 13.214-3.189 13.214-9.92Zm15.916 19.41c-3.057-2.447-7.127-3.825-11.436-3.825-4.42 0-8.587 1.45-11.665 4.012-1.075.895-1.244 2.52-.377 3.63a2.447 2.447 0 0 0 3.515.388c2.17-1.805 5.225-2.869 8.527-2.869 3.222 0 6.21 1.012 8.372 2.743a2.448 2.448 0 0 0 3.508-.458c.846-1.127.647-2.748-.444-3.621Z",clipRule:"evenodd"})))},re=({children:e,title:t,buttonText:n="На главную"})=>(0,s.jsxs)("div",{className:ne.Z.notfound,children:[(0,s.jsx)(ae,{className:ne.Z.image,"aria-hidden":"true"}),(0,s.jsx)("h1",{className:ne.Z.title,children:t}),e,(0,s.jsx)(l.rU,{to:u.$x,children:(0,s.jsx)(x.ZP,{type:"link",children:n})})]}),oe=function(){return(0,s.jsx)("div",{className:"content container",children:(0,s.jsx)(re,{title:"Страница не найдена",buttonText:"На главную"})})},ie=(0,a.lazy)((()=>Promise.all([n.e(734),n.e(529)]).then(n.bind(n,6529)))),le=()=>{const{error:e,loading:t,totalQuestions:n}=(0,r.C)(I.y2);return(0,s.jsx)(s.Fragment,{children:t||!e&&0!==n?(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(B.Z,{}),children:(0,s.jsx)(ie,{})}):(0,s.jsx)(R,{title:e,withButton:!0})})};var ce=n(3147),de=n(3935);const ue=({children:e,isOpen:t,onClose:n})=>{const r=(0,a.useRef)(null);return(0,de.createPortal)((0,s.jsx)("div",{ref:r,className:C()(ce.Z.modal,{[ce.Z.modal_active]:t}),onMouseDown:n,children:(0,s.jsx)("div",{className:C()(ce.Z.modal__content,{[ce.Z.modal__content_active]:t}),onMouseDown:e=>e.stopPropagation(),children:e})}),document.getElementById("modal-root"))},he=a.memo((({isModal:e,location:t})=>{var n,o;const l=null===(n=t.state)||void 0===n?void 0:n.initialPath,c=null===(o=t.state)||void 0===o?void 0:o.backgroundLocation,d=(0,i.s0)(),h=(0,r.T)(),m=()=>{d(l||u.$x,{replace:!0})},p=(0,a.useCallback)((e=>{h((e=>t=>{t(f(!0)),w.userRegister(e).then((e=>{t(function(e){return{type:g.pS,payload:e}}(e.user.aud))})).catch((e=>t(b(e.toString())))).finally((()=>t(f(!1))))})(e))}),[]),x=(0,a.useCallback)((e=>{h((e=>t=>{t(f(!0)),w.userLogin(e).then((e=>{t(function(e){return{type:g.bc,payload:e}}(e.user))})).catch((e=>t(b(e.toString())))).finally((()=>{t(f(!1)),t({type:g.YX})}))})(e))}),[]),j=e=>{d(e)},v=e=>{d(e,{replace:!0,state:{backgroundLocation:Object.assign(Object.assign({},t),{state:null}),initialPath:l}})},y=[{path:u.$x,element:(0,s.jsx)(ee,{})},{path:u.e7,element:(0,s.jsx)(X,{children:(0,s.jsx)(le,{})})},{path:u.Qv,element:(0,s.jsx)(X,{onlyOnAuth:!0,children:(0,s.jsx)(G,{onSubmit:x,onNavigate:j})})},{path:u.NM,element:(0,s.jsx)(X,{onlyOnAuth:!0,children:(0,s.jsx)(V,{onSubmit:p,onNavigate:j})})},{path:"*",element:(0,s.jsx)(oe,{})}],Z=[{path:u.NM,element:(0,s.jsx)(X,{onlyOnAuth:!0,children:(0,s.jsx)(ue,{isOpen:!0,onClose:m,children:(0,s.jsx)(V,{onSubmit:p,onNavigate:v})})})},{path:u.Qv,element:(0,s.jsx)(X,{onlyOnAuth:!0,children:(0,s.jsx)(ue,{isOpen:!0,onClose:m,children:(0,s.jsx)(G,{onSubmit:x,onNavigate:v})})})},{path:"*",element:null}];return!0===e?c&&(0,s.jsx)(i.Z5,{children:Z.map((({path:e,element:t})=>(0,s.jsx)(i.AW,{path:e,element:t},e)))}):(0,s.jsx)(i.Z5,{location:c&&Object.assign(Object.assign({},c),{pathname:l})||t,children:y.map((({path:e,element:t})=>(0,s.jsx)(i.AW,{path:e,element:t},e)))})})),{Footer:me}=o.default,pe=a.memo((()=>{var e,t;const n=(0,r.T)(),o=(0,i.TH)(),l=null===(e=_(u.bI))||void 0===e?void 0:e.access_token,c=null===(t=_(u.bI))||void 0===t?void 0:t.user;return(0,a.useEffect)((()=>{var e;c&&n((e=c,{type:g.lQ,payload:e})),l&&n((e=>{e(M(!0)),w.fetchQuestions().then((t=>{var n;e((n=t,{type:g.pk,payload:n}))})).catch((t=>{var n;e((n=t.toString(),{type:g.qZ,payload:n}))})).finally((()=>e(M(!1))))}))}),[l,n]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{}),(0,s.jsx)("main",{className:"container",children:(0,s.jsx)(he,{location:o})}),(0,s.jsx)(me,{style:{textAlign:"center"},children:"Ant Design ©2023 Created by Maxim Mikhaylenko"}),(0,s.jsx)(he,{isModal:!0,location:o})]})}))},4927:(e,t,n)=>{n.d(t,{F_:()=>i,Ub:()=>r,dG:()=>a,vm:()=>o});var s=n(8268);function a(){return{type:s.GM}}function r(){return{type:s.bN}}function o(e){return{type:s.LM,payload:e}}function i(e){return{type:s.t5,payload:e}}},7421:(e,t,n)=>{n.d(t,{C:()=>r,T:()=>a});var s=n(5998);const a=s.I0,r=s.v9},3106:(e,t,n)=>{n.d(t,{$v:()=>l,Ee:()=>r,kH:()=>s,qL:()=>c,rt:()=>a,st:()=>i,y2:()=>o});const s=e=>e.result.answers,a=e=>e.result.showResult,r=e=>e.result.score,o=e=>e.questions,i=e=>e.questions.data,l=e=>e.user.data,c=e=>e.user}}]);