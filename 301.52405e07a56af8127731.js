"use strict";(self.webpackChunkcinema_quiz=self.webpackChunkcinema_quiz||[]).push([[301],{7555:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"AqOb_Kbe"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3896:(e,t,n)=>{n.d(t,{Z:()=>s});const s={btn:"qfNxdn_0",primary:"D93lf_uC",secondary:"MjvObtZH",full:"sa2cfRF0",minContent:"ac0L1gon"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3698:(e,t,n)=>{n.d(t,{Z:()=>s});const s={input:"Q_Pov6im"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},8257:(e,t,n)=>{n.d(t,{Z:()=>s});const s={container:"UcmHv9_m",form:"J_WaL6wm",title:"vHm30li_",left:"YjOrunbt",center:"z9Et_3Da",right:"Y8f9sfS_"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3706:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"kmoMZMB_",header:"zB0MpvEd"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},1357:(e,t,n)=>{n.d(t,{Z:()=>s});const s={logo:"sL22ySrC",text:"kqxmnxGG"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},3147:(e,t,n)=>{n.d(t,{Z:()=>s});const s={modal:"D5MP1HXo",modal_active:"q4xPvY1V",modal__content:"T8Tn8w78",modal__content_active:"PymjAh24"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},5158:(e,t,n)=>{n.d(t,{Z:()=>s});const s={notfound:"JhhcHpca",title:"NBNE9yms",image:"xy0FiEGI"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},1822:(e,t,n)=>{n.d(t,{Z:()=>s});const s={userBlock:"iI_qxwbv",userIcon:"BXzJKcvj"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},9885:(e,t,n)=>{n.d(t,{Z:()=>s});const s={wrapper:"yXmhqWQI"};var a=n(4783)(e.id,{locals:!0});e.hot.dispose(a)},301:(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var s=n(5893),a=n(7294),r=n(7421),o=n(9175),i=n(9250),l=n(3553),c=n(3106);const d=({onlyOnAuth:e,children:t})=>{const n=(0,i.TH)();return(({onlyOnAuth:e,user:t,location:n,children:a})=>{var r,o,c;if(e&&t){const e=(null===(r=null==n?void 0:n.state)||void 0===r?void 0:r.from)||{pathname:l.$x},{backgroundLocation:t}=(null===(c=null===(o=null==n?void 0:n.state)||void 0===o?void 0:o.from)||void 0===c?void 0:c.state)||{backgroundLocation:null};return(0,s.jsx)(i.Fg,{replace:!0,to:e,state:{backgroundLocation:t}})}return e||t?(0,s.jsx)(s.Fragment,{children:a}):(0,s.jsx)(i.Fg,{replace:!0,to:{pathname:l.Qv},state:{from:n}})})({onlyOnAuth:e,user:(0,r.C)(c.$v),location:n,children:t})};var u=n(9655),h=n(1357),m=n(9234);const{Title:p}=m.default,x=a.memo((()=>{const e=(0,i.TH)();return(0,s.jsx)(u.rU,{to:l.$x,className:h.Z.logo,onClick:t=>{e.pathname===l.$x&&t.preventDefault()},children:(0,s.jsx)(p,{level:2,className:h.Z.text,children:"QUIZ LOGO"})})}));var j=n(3706),v=n(1577),y=n(1822),g=n(9366),b=n(4927),f=n(8268);function Z(e){return{type:f.zA,payload:e}}function w(e){return{type:f.YG,payload:e}}const O=(0,n(9465).eI)("https://bomuwhgrujvwagkdtdrd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJvbXV3aGdydWp2d2Fna2R0ZHJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODk2MTYyODYsImV4cCI6MjAwNTE5MjI4Nn0.2LO4Ex7y-KG9iInHcoK3JPIYZMFR0ZiEW6iWQV9YQt0"),I=new class{constructor({baseUrl:e,headers:t}){this.userRegister=async e=>{const{data:t,error:n}=await O.auth.signUp(e);if(n)throw new Error(n.message.toString());return t},this.userLogin=async e=>{const{data:t,error:n}=await O.auth.signInWithPassword(e);if(n)throw new Error(n.message.toString());return t},this.userLogout=async()=>{await O.auth.signOut()},this.fetchQuestions=async()=>{const{data:e,error:t}=await O.from("questions").select();if(t||0===e.length){const e=t.message||"Нет данных";throw new Error(e.toString())}return e},this.baseUrl=e,this.headers=t}onResponce(e){if(e.ok)return e.json();throw new Error(`${e.status} - ${e.statusText}`)}refreshToken(e){return fetch(`${this.baseUrl}/auth/v1/token?grant_type=refresh_token`,{method:"POST",headers:Object.assign({},this.headers),body:JSON.stringify({refresh_token:e})}).then(this.onResponce).catch((e=>alert(e)))}}({baseUrl:"https://bomuwhgrujvwagkdtdrd.supabase.co",headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJvbXV3aGdydWp2d2Fna2R0ZHJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODk2MTYyODYsImV4cCI6MjAwNTE5MjI4Nn0.2LO4Ex7y-KG9iInHcoK3JPIYZMFR0ZiEW6iWQV9YQt0"}});function N(e){const t=(0,a.useMemo)((()=>window.matchMedia(e)),[e]),[n,s]=(0,a.useState)(t.matches);return(0,a.useEffect)((()=>{const e=()=>s(t.matches);return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}),[t]),n}const k=a.memo((()=>{const e=(0,r.C)(c.$v),t=(0,r.T)(),n=(0,i.TH)(),{sm:o}={xs:N("(min-width: 480px)"),sm:N("(min-width: 767px)"),md:N("(min-width: 992px)"),lg:N("(min-width: 1200px)")},d=(0,a.useCallback)((()=>{t((e=>{e((0,b.Ub)()),e({type:f.lK}),I.userLogout()}))}),[]);return(0,s.jsxs)("div",{className:y.Z.userBlock,children:[(null==e?void 0:e.email)&&(0,s.jsxs)("span",{children:[(0,s.jsx)(g.Z,{className:y.Z.userIcon}),o&&e.email]}),e?(0,s.jsx)(u.rU,{to:l.$x,children:(0,s.jsx)(v.ZP,{type:"primary",onClick:d,children:"Выйти"})}):(0,s.jsx)(u.rU,{replace:!0,to:l.Qv,state:{backgroundLocation:n,initialPath:n.pathname},children:(0,s.jsx)(v.ZP,{type:"primary",children:"Войти"})})]})}));var C=n(4184),S=n.n(C);const _=()=>(0,s.jsx)("header",{className:j.Z.wrapper,children:(0,s.jsxs)("div",{className:S()("container",j.Z.header),children:[(0,s.jsx)(x,{}),(0,s.jsx)(k,{})]})});var M=n(7536),P=n(8257);const E=a.memo((({handleForm:e,children:t,title:n,align:a="center"})=>(0,s.jsx)("div",{className:P.Z.container,children:(0,s.jsxs)("form",{onSubmit:e,className:S()(P.Z.form,{[P.Z[a]]:!!a}),children:[n&&(0,s.jsx)("h3",{className:P.Z.title,children:n}),t]})})));var J=n(3698);const L=(0,a.forwardRef)(((e,t)=>{var n=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n}(e,[]);return(0,s.jsx)("input",Object.assign({ref:t,className:J.Z.input},n))})),T=a.memo(L);var F,z=n(3896);!function(e){e.full="full"}(F||(F={}));const A=a.memo((e=>{var{children:t,color:n,size:a=F.full,extraClass:r}=e,o=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(n[s[a]]=e[s[a]])}return n}(e,["children","color","size","extraClass"]);return(0,s.jsx)("button",Object.assign({},o,{className:S()(z.Z.btn,z.Z[n],{[r]:!!r,[z.Z[a]]:!!a}),children:t}))})),$={required:{value:!1,message:"Обязательное поле"},pattern:{value:/^[а-яА-ЯёЁa-zA-Z][а-яА-ЯёЁa-zA-Z0-9-_\.]{1,20}$/,message:"Имя должно быть не менее 2 букв и начинаться с буквы"}},Q={required:{value:!0,message:"Обязательное поле"},pattern:{value:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Email не соотвествует формату электронной почты"}},q={required:{value:!0,message:"Обязательное поле"},pattern:{value:/^.{8,}$/,message:"Пароль должен содержать минимум восемь символов"}},U=(e,t)=>{if(t[e])return(0,s.jsx)("p",{className:"error-message",children:t[e].message})};var Y=n(7555);const H=a.memo((({title:e,subtitle:t,withButton:n})=>(0,s.jsxs)("div",{className:Y.Z.wrapper,children:[e&&(0,s.jsx)("p",{className:"error-message",children:e}),t&&(0,s.jsx)("p",{className:"error-message",children:t}),n&&(0,s.jsx)(u.rU,{to:l.$x,children:(0,s.jsx)(v.ZP,{type:"primary",children:"На главную"})})]})));var R=n(4324);const B=a.memo((({onSubmit:e,onNavigate:t})=>{const{error:n,loading:o}=(0,r.C)(c.qL),{register:i,handleSubmit:d,formState:{errors:u}}=(0,M.cI)({mode:"onBlur"}),h=i("email",Q),m=i("password",q),p=(0,a.useCallback)((()=>{t(l.NM)}),[]);return(0,s.jsxs)(E,{title:"Вход",handleForm:d(e),children:[(0,s.jsx)(T,Object.assign({},h,{id:"email",type:"text",placeholder:"email",autoComplete:"none"})),U("email",u),(0,s.jsx)(T,Object.assign({},m,{id:"password",type:"password",placeholder:"Пароль"})),U("password",u),o&&(0,s.jsx)(R.Z,{}),n&&(0,s.jsx)(H,{title:"Ошибка авторизации",subtitle:n}),(0,s.jsx)(A,{type:"submit",color:"primary",children:"Войти"}),(0,s.jsx)(A,{onClick:p,type:"button",color:"secondary",children:"Зарегистрироваться"})]})})),{Text:G,Title:X}=m.default,D=a.memo((({onSubmit:e,onNavigate:t})=>{const{error:n,loading:o,authorization:i}=(0,r.C)(c.qL),{register:d,handleSubmit:u,formState:{errors:h}}=(0,M.cI)({mode:"onBlur"}),m=d("name",$),p=d("email",Q),x=d("password",q),j=(0,a.useCallback)((()=>t(l.Qv)),[]);return(0,s.jsxs)(E,{title:"Регистрация",handleForm:u(e),children:[i===l.h$?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{level:3,type:"success",children:"Вы успешно зарегистрированы!"}),(0,s.jsx)(G,{children:"Для входа в систему, необходимо подтвердить свой email"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,Object.assign({},m,{id:"username",type:"text",placeholder:"Имя"})),U("name",h),(0,s.jsx)(T,Object.assign({},p,{id:"email",type:"email",placeholder:"email"})),U("email",h),(0,s.jsx)(T,Object.assign({},x,{id:"password",type:"password",placeholder:"Пароль"})),U("password",h),o&&(0,s.jsx)(R.Z,{}),n&&(0,s.jsx)(H,{title:"Ошибка авторизации",subtitle:n}),(0,s.jsx)("p",{className:"info-text",children:"Для регистрации нужно указать реальный email! Действует ограничение 4 регистрации за 1 час"}),(0,s.jsx)(A,{type:"submit",color:"primary",children:"Зарегистрироваться"})]}),(0,s.jsx)(A,{onClick:j,type:"button",color:"secondary",children:"Войти"})]})})),W=e=>JSON.parse(localStorage.getItem(e));function V(e){return{type:f.$E,payload:e}}var K=n(9885);const ee=function(){const e=(0,r.C)(c.$v),t=(0,i.TH)(),n={hash:"",key:"defailt",pathname:l.e7,state:{}};return(0,s.jsxs)("div",{className:K.Z.wrapper,children:[(0,s.jsx)("h2",{children:"Здесь можно пройти квиз"}),e?(0,s.jsx)(u.rU,{to:l.e7,children:(0,s.jsx)(v.ZP,{type:"primary",children:"Играть"})}):(0,s.jsx)(u.rU,{replace:!0,to:l.Qv,state:{backgroundLocation:t,initialPath:t.pathname,from:n},children:(0,s.jsx)(v.ZP,{type:"primary",children:"Авторизироваться"})})]})};var te=n(3147),ne=n(3935);const se=({children:e,isOpen:t,onClose:n})=>{const r=(0,a.useRef)(null);return(0,ne.createPortal)((0,s.jsx)("div",{ref:r,className:S()(te.Z.modal,{[te.Z.modal_active]:t}),onMouseDown:n,children:(0,s.jsx)("div",{className:S()(te.Z.modal__content,{[te.Z.modal__content_active]:t}),onMouseDown:e=>e.stopPropagation(),children:e})}),document.getElementById("modal-root"))},ae=(0,a.lazy)((()=>Promise.all([n.e(734),n.e(529)]).then(n.bind(n,6529)))),re=()=>{const{error:e,loading:t,totalQuestions:n}=(0,r.C)(c.y2);return(0,s.jsx)(s.Fragment,{children:t||!e&&0!==n?(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(R.Z,{}),children:(0,s.jsx)(ae,{})}):(0,s.jsx)(H,{title:e,withButton:!0})})};var oe,ie=n(5158);function le(){return le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},le.apply(this,arguments)}const ce=function(e){return a.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 80 80"},e),oe||(oe=a.createElement("path",{d:"M40 6.667C58.41 6.667 73.334 21.59 73.334 40c0 18.41-14.924 33.333-33.334 33.333C21.59 73.333 6.667 58.41 6.667 40 6.667 21.59 21.591 6.667 40 6.667Zm0 5.666C24.72 12.333 12.334 24.72 12.334 40c0 15.28 12.386 27.667 27.666 27.667 15.28 0 27.667-12.387 27.667-27.667 0-15.28-12.387-27.667-27.667-27.667Zm6.787 21c-1.327 0-2.403 1.11-2.403 2.48 0 6.731 5.307 9.92 13.214 9.92 1.326 0 2.402-1.11 2.402-2.48 0-1.37-1.076-2.48-2.402-2.48-5.604 0-8.409-1.686-8.409-4.96 0-1.37-1.075-2.48-2.402-2.48Zm-11.171 2.48c0-1.37-1.076-2.48-2.403-2.48s-2.402 1.11-2.402 2.48l-.018.437c-.243 2.987-3.042 4.523-8.39 4.523-1.327 0-2.403 1.11-2.403 2.48 0 1.37 1.076 2.48 2.402 2.48 7.907 0 13.214-3.189 13.214-9.92Zm15.916 19.41c-3.057-2.447-7.127-3.825-11.436-3.825-4.42 0-8.587 1.45-11.665 4.012-1.075.895-1.244 2.52-.377 3.63a2.447 2.447 0 0 0 3.515.388c2.17-1.805 5.225-2.869 8.527-2.869 3.222 0 6.21 1.012 8.372 2.743a2.448 2.448 0 0 0 3.508-.458c.846-1.127.647-2.748-.444-3.621Z",clipRule:"evenodd"})))},de=({children:e,title:t,buttonText:n="На главную"})=>(0,s.jsxs)("div",{className:ie.Z.notfound,children:[(0,s.jsx)(ce,{className:ie.Z.image,"aria-hidden":"true"}),(0,s.jsx)("h1",{className:ie.Z.title,children:t}),e,(0,s.jsx)(u.rU,{to:l.$x,children:(0,s.jsx)(v.ZP,{type:"link",children:n})})]}),ue=function(){return(0,s.jsx)("div",{className:"content container",children:(0,s.jsx)(de,{title:"Страница не найдена",buttonText:"На главную"})})},he=a.memo((({isModal:e,routes:t})=>{var n,a;const r=(0,i.TH)(),o=null===(n=r.state)||void 0===n?void 0:n.initialPath,l=null===(a=r.state)||void 0===a?void 0:a.backgroundLocation;return!0===e?l&&(0,s.jsx)(i.Z5,{children:t.map((({path:e,element:t})=>(0,s.jsx)(i.AW,{path:e,element:t},e)))}):(0,s.jsx)(i.Z5,{location:l&&Object.assign(Object.assign({},l),{pathname:o})||r,children:t.map((({path:e,element:t})=>(0,s.jsx)(i.AW,{path:e,element:t},e)))})})),{Footer:me}=o.default,pe=a.memo((()=>{var e,t,n;const o=(0,r.T)(),c=(0,i.TH)(),u=null===(e=c.state)||void 0===e?void 0:e.initialPath,h=(0,i.s0)(),m=null===(t=W(l.bI))||void 0===t?void 0:t.access_token,p=null===(n=W(l.bI))||void 0===n?void 0:n.user;(0,a.useEffect)((()=>{var e;p&&o((e=p,{type:f.lQ,payload:e})),m&&o((e=>{e(V(!0)),I.fetchQuestions().then((t=>{var n;e((n=t,{type:f.pk,payload:n}))})).catch((t=>{var n;e((n=t.toString(),{type:f.qZ,payload:n}))})).finally((()=>e(V(!1))))}))}),[m,o]);const x=()=>{h(u||l.$x,{replace:!0})},j=e=>{o((e=>t=>{t(w(!0)),I.userRegister(e).then((e=>{t(function(e){return{type:f.pS,payload:e}}(e.user.aud))})).catch((e=>t(Z(e.toString())))).finally((()=>t(w(!1))))})(e))},v=e=>{o((e=>t=>{t(w(!0)),I.userLogin(e).then((e=>{t(function(e){return{type:f.bc,payload:e}}(e.user))})).catch((e=>t(Z(e.toString())))).finally((()=>{t(w(!1)),t({type:f.YX})}))})(e))},y=e=>{h(e)},g=e=>{h(e,{replace:!0,state:{backgroundLocation:Object.assign(Object.assign({},c),{state:null}),initialPath:u}})},b=[{path:l.$x,element:(0,s.jsx)(ee,{})},{path:l.e7,element:(0,s.jsx)(d,{children:(0,s.jsx)(re,{})})},{path:l.Qv,element:(0,s.jsx)(d,{onlyOnAuth:!0,children:(0,s.jsx)(B,{onSubmit:v,onNavigate:y})})},{path:l.NM,element:(0,s.jsx)(d,{onlyOnAuth:!0,children:(0,s.jsx)(D,{onSubmit:j,onNavigate:y})})},{path:"*",element:(0,s.jsx)(ue,{})}],O=[{path:l.NM,element:(0,s.jsx)(d,{onlyOnAuth:!0,children:(0,s.jsx)(se,{isOpen:!0,onClose:x,children:(0,s.jsx)(D,{onSubmit:j,onNavigate:g})})})},{path:l.Qv,element:(0,s.jsx)(d,{onlyOnAuth:!0,children:(0,s.jsx)(se,{isOpen:!0,onClose:x,children:(0,s.jsx)(B,{onSubmit:v,onNavigate:g})})})},{path:"*",element:null}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_,{}),(0,s.jsx)("main",{className:"container",children:(0,s.jsx)(he,{routes:b})}),(0,s.jsx)(me,{style:{textAlign:"center"},children:"Ant Design ©2023 Created by Maxim Mikhaylenko"}),(0,s.jsx)(he,{isModal:!0,routes:O})]})}))},4927:(e,t,n)=>{n.d(t,{F_:()=>i,Ub:()=>r,dG:()=>a,vm:()=>o});var s=n(8268);function a(){return{type:s.GM}}function r(){return{type:s.bN}}function o(e){return{type:s.LM,payload:e}}function i(e){return{type:s.t5,payload:e}}},7421:(e,t,n)=>{n.d(t,{C:()=>r,T:()=>a});var s=n(5998);const a=s.I0,r=s.v9},3106:(e,t,n)=>{n.d(t,{$v:()=>l,Ee:()=>r,kH:()=>s,qL:()=>c,rt:()=>a,st:()=>i,y2:()=>o});const s=e=>e.result.answers,a=e=>e.result.showResult,r=e=>e.result.score,o=e=>e.questions,i=e=>e.questions.data,l=e=>e.user.data,c=e=>e.user}}]);